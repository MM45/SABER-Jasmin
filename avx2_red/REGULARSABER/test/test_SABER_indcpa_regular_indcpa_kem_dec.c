/*** test_SABER_indcpa_regular_indcpa_kem_dec.c: File containing the unit test for the indcpa_kem_dec function, with (regular) SABER parameters ***/

#include <stdio.h>
#include <stdint.h>

#include "SABER_params.h"
#include "../../GENERAL/SABER_indcpa.h"
#include "randomtestdata.h"

int main()
{
	// Loop variable
	int i;

	// Declare variables for test
	unsigned char sk_c[SABER_INDCPA_SECRETKEYBYTES] = {1, 0, 0, 252, 127, 1, 32, 0, 0, 0, 0, 0, 0, 2, 0, 0, 4, 128, 255, 239, 255, 1, 128, 0, 240, 255, 0, 32, 0, 8, 128, 255, 31, 0, 0, 64, 255, 15, 0, 0, 160, 255, 3, 128, 0, 240, 255, 3, 0, 0, 24, 0, 0, 32, 0, 252, 127, 1, 16, 0, 2, 128, 0, 0, 0, 1, 64, 0, 8, 128, 0, 0, 0, 2, 0, 0, 0, 0, 255, 191, 255, 7, 128, 0, 0, 0, 0, 0, 0, 8, 0, 254, 31, 0, 248, 255, 0, 16, 0, 2, 0, 0, 8, 0, 255, 127, 0, 0, 0, 0, 0, 0, 254, 191, 255, 7, 0, 1, 224, 255, 7, 128, 255, 31, 0, 4, 0, 0, 240, 255, 254, 255, 255, 255, 127, 1, 0, 0, 2, 128, 255, 247, 255, 255, 255, 255, 251, 255, 0, 208, 255, 251, 191, 255, 7, 0, 0, 32, 0, 252, 127, 0, 0, 0, 252, 255, 0, 240, 255, 253, 191, 255, 3, 0, 0, 224, 255, 1, 64, 0, 248, 255, 0, 0, 0, 248, 127, 0, 16, 0, 2, 0, 0, 24, 0, 4, 0, 0, 8, 0, 0, 240, 255, 9, 192, 255, 255, 255, 1, 96, 0, 4, 128, 255, 31, 0, 250, 127, 0, 248, 255, 254, 31, 0, 252, 255, 1, 16, 0, 254, 127, 255, 7, 0, 0, 0, 0, 4, 0, 255, 15, 0, 254, 255, 255, 39, 0, 1, 0, 0, 4, 128, 0, 208, 255, 3, 64, 255, 255, 255, 255, 63, 0, 244, 127, 1, 224, 255, 1, 0, 0, 248, 255, 1, 64, 0, 8, 0, 255, 15, 0, 0, 0, 0, 0, 0, 0, 32, 0, 252, 127, 1, 224, 255, 3, 192, 0, 0, 0, 0, 0, 0, 0, 128, 0, 240, 255, 253, 63, 0, 248, 255, 1, 0, 0, 252, 127, 255, 47, 0, 252, 127, 0, 0, 0, 255, 31, 0, 252, 255, 0, 0, 0, 0, 128, 255, 7, 0, 0, 64, 0, 248, 127, 0, 224, 255, 251, 127, 0, 8, 0, 254, 63, 0, 8, 0, 255, 15, 0, 0, 64, 0, 248, 255, 254, 63, 0, 4, 0, 1, 0, 0, 0, 64, 0, 8, 0, 253, 255, 255, 251, 255, 254, 47, 0, 2, 0, 0, 232, 255, 0, 0, 0, 252, 127, 1, 0, 0, 254, 255, 0, 240, 255, 0, 224, 255, 3, 0, 255, 31, 0, 254, 255, 255, 247, 255, 2, 32, 0, 0, 128, 0, 16, 0, 250, 127, 0, 16, 0, 0, 192, 255, 255, 255, 255, 255, 255, 251, 127, 0, 248, 255, 2, 192, 255, 255, 127, 255, 15, 0, 0, 128, 0, 248, 255, 0, 192, 255, 251, 127, 0, 0, 0, 2, 0, 0, 0, 0, 3, 0, 0, 8, 128, 0, 16, 0, 252, 63, 0, 0, 0, 1, 224, 255, 3, 0, 0, 240, 255, 253, 127, 0, 24, 0, 0, 0, 0, 0, 128, 255, 223, 255, 255, 255, 255, 15, 0, 0, 0, 0, 4, 0, 1, 32, 0, 0, 0, 0, 8, 0, 255, 191, 255, 255, 255, 0, 0, 0, 2, 0, 0, 248, 255, 1, 192, 255, 251, 127, 0, 208, 255, 253, 255, 255, 239, 255, 1, 0, 0, 16, 128, 0, 16, 0, 2, 192, 0, 0, 0, 254, 63, 0, 248, 255, 255, 15, 0, 0, 64, 0, 248, 255, 1, 0, 0, 248, 255, 255, 255, 255, 1, 128, 0, 248, 255, 0, 224, 255, 3, 0, 255, 47, 0, 0, 0, 0, 32, 0, 255, 63, 0, 252, 127, 0, 0, 0, 0, 192, 255, 7, 0, 0, 64, 0, 244, 127, 0, 32, 0, 2, 128, 0, 8, 0, 1, 0, 0, 252, 255, 255, 255, 255, 255, 191, 255, 255, 255, 1, 0, 0, 244, 127, 0, 224, 255, 3, 64, 0, 0, 0, 1, 224, 255, 3, 0, 0, 16, 0, 0, 0, 0, 240, 255, 0, 0, 0, 0, 0, 2, 16, 0, 2, 128, 0, 16, 0, 255, 31, 0, 0, 128, 255, 15, 0, 0, 192, 255, 7, 0, 254, 31, 0, 248, 255, 255, 31, 0, 252, 63, 0, 232, 255, 254, 31, 0, 8, 128, 255, 15, 0, 252, 255, 255, 15, 0, 253, 95, 0, 0, 128, 0, 240, 255, 3, 192, 255, 15, 0, 1, 224, 255, 11, 0, 0, 224, 255, 5, 64, 0, 0, 0, 255, 127, 0, 16, 128, 255, 223, 255, 5, 0, 0, 240, 255, 255, 255, 255, 3, 128, 255, 223, 255, 255, 191, 0, 16, 0, 2, 32, 0, 252, 255, 255, 47, 0, 2, 128, 0, 32, 0, 255, 191, 255, 3, 0, 255, 255, 255, 255, 63, 0, 8, 0, 0, 32, 0, 8, 128, 0, 0, 0, 252, 255, 255, 23, 0, 255, 223, 255, 7, 0, 0, 240, 255, 1, 128, 0, 8, 0, 253, 31, 0, 252, 255, 0, 224, 255, 255, 191, 255, 231, 255, 1, 224, 255, 251, 255, 0, 224, 255, 1, 64, 0, 16, 0, 0, 224, 255, 247, 255, 255, 63, 0, 250, 127, 0, 0, 0, 3, 32, 0, 248, 127, 0, 16, 0, 2, 128, 255, 255, 255, 2, 0, 0, 8, 128, 255, 31, 0, 250, 255, 255, 255, 255, 254, 31, 0, 252, 127, 2, 16, 0, 250, 191, 0, 0, 0, 255, 95, 0, 0, 0, 0, 224, 255, 3, 128, 0, 240, 255, 0, 224, 255, 3, 128, 0, 0, 0, 254, 63, 0, 8, 0, 2, 64, 0, 0, 128, 255, 31, 0, 0, 64, 0, 248, 255, 255, 127, 0, 252, 127, 0, 224, 255, 1, 192, 255, 255, 255, 255, 255, 255, 255, 255, 0, 0, 0, 250, 191, 255, 31, 0, 255, 191, 255, 7, 128, 255, 15, 0, 250, 191, 255, 23, 0, 0, 96, 0, 4, 0, 0, 224, 255, 251, 127, 0, 248, 255, 3, 0, 0, 248, 255, 255, 255, 255, 255, 127, 0, 248, 255, 1, 224, 255, 11, 128, 255, 239, 255, 255, 63, 0, 248, 255, 1, 32, 0, 8, 128, 0, 48, 0, 250, 191, 0, 0, 0, 0, 224, 255, 255, 127, 1, 16, 0, 252, 63, 0, 8, 0, 254, 31, 0, 252, 127, 255, 255, 255, 5, 0, 0, 24, 0, 0, 192, 255, 3, 0, 1, 240, 255, 253, 63, 0, 0, 0, 0, 224, 255, 7, 128, 255, 15, 0, 2, 0, 0, 240, 255, 0, 0, 0, 0, 128, 0, 0, 0, 2, 0, 0, 16, 0, 0, 32, 0, 244, 127, 0, 0, 0, 252, 191, 0, 248, 255, 1, 64, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 4, 0, 2, 224, 255, 255, 127, 0, 16, 0, 2, 0, 0, 4, 0, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 224, 255, 253, 63, 0, 16, 0, 3, 224, 255, 3, 0, 255, 31, 0, 0, 192, 0, 0, 0, 0, 64, 0, 252, 127, 0, 240, 255, 3, 64, 0, 248, 255, 2, 64, 0, 4, 0, 0, 16, 0, 2, 64, 0, 0, 0, 255, 31, 0, 0, 0, 0, 32, 0, 254, 63, 0, 0, 0, 0, 0, 0, 0, 128, 255, 15, 0, 0, 0, 0, 248, 255, 3, 32, 0, 244, 127, 1, 32, 0, 6, 0, 1, 16, 0, 254, 63, 0, 0, 0, 0, 0, 0, 0, 192, 255, 23, 0};
	unsigned char sk_jazz[SABER_INDCPA_SECRETKEYBYTES];
	unsigned char ciphertext_c[SABER_BYTES_CCA_DEC];
	unsigned char ciphertext_jazz[SABER_BYTES_CCA_DEC];
	unsigned char message_dec_c[SABER_KEYBYTES];
	unsigned char message_dec_jazz[SABER_KEYBYTES];

	// Initialize variables for test
	//random_test_bytes(sk_c, SABER_INDCPA_SECRETKEYBYTES);
	random_test_bytes(ciphertext_c, SABER_BYTES_CCA_DEC);
	
	for (i = 0; i < SABER_INDCPA_SECRETKEYBYTES; ++i) {
		sk_jazz[i] = sk_c[i];
	}

	for (i = 0; i < SABER_BYTES_CCA_DEC; ++i) {
		ciphertext_jazz[i] = ciphertext_c[i];
	}

	// Test
	indcpa_kem_dec(sk_c, ciphertext_c, message_dec_c);
	indcpa_kem_dec_jazz(sk_jazz, ciphertext_jazz, message_dec_jazz);

	for (i = 0; i < SABER_KEYBYTES; ++i) {
		if (message_dec_c[i] != message_dec_jazz[i]) {
			printf("[!] Unit test failed.\nFunction:\t indcpa_kem_dec.\nReason:\tmessage_dec_c[%d] != message_dec_jazz[%d] ==> %d != %d\n", i, i, message_dec_c[i], message_dec_jazz[i]);
		}
	}

}