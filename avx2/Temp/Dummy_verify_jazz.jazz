
param int SABER_N = 256;
param int SABER_KEYBYTES = 32;

fn cmov(stack u8[SABER_KEYBYTES] r, stack u8[SABER_KEYBYTES] x, reg u8 b) -> stack u8[SABER_KEYBYTES]
{
	inline int i;

	reg u8 t8;

	reg u64 t64;
	
	t64 = (64u) b;
	t64 *= -1;
	b = (8u) t64;

	for i = 0 to SABER_KEYBYTES {
		// r[i] ^= (-b) & (x[i] ^ r[i]);
		t8 = x[i];
		t8 ^= r[i];
		t8 &= b;
		r[i] ^= t8;
	}

	return r;
}

export fn dummy()
{
	stack u16[SABER_N] r;
	stack u8[SABER_KEYBYTES] x;
	reg u8 b;

	b = 1;

	r = cmov(r, x, b);
}
	